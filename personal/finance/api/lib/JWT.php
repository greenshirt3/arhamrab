<?php
namespace Lib;
class JWT { public static function encode($payload, $secret) { $header = array('alg'=>'HS256','typ'=>'JWT'); $segments = array(self::b64(json_encode($header)), self::b64(json_encode($payload))); $signingInput = implode('.', $segments); $signature = self::b64(hash_hmac('sha256', $signingInput, $secret, true)); return $signingInput . '.' . $signature; } public static function decode($jwt, $secret) { $parts = explode('.', $jwt); if (count($parts) !== 3) return null; list($h, $p, $s) = $parts; $validSig = self::b64(hash_hmac('sha256', $h.'.'.$p, $secret, true)); if (!hash_equals($validSig, $s)) return null; return json_decode(self::ub64($p), true); } private static function b64($s) { return rtrim(strtr(base64_encode($s), '+/', '-_'), '='); } private static function ub64($s) { return base64_decode(strtr($s, '-_', '+/')); } }
